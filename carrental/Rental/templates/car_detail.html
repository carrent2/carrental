{% extends "base.html" %}

{% block title %}{{ car.brand }} {{ car.model }}{% endblock %}

{% block content %}
    <h1 class="car-detail-header">{{ car.brand }} {{ car.model }}</h1>
    <div class="car-details">
        <p><strong>Rok:</strong> {{ car.year }}</p>
        <p><strong>Zaliczka:</strong> {{ car.deposit }}</p>
        <p><strong>Cena PLN / dzień:</strong> {{ car.price }}</p>
        <img src="{{ car.image.url }}" alt="Car Image" class="car-image">
    </div>
    
    <div class="car-actions">
        <a href="{% url 'rent_car' car.id %}" class="btn btn-primary car-action-btn">ZAREZERWUJ</a>
        {% if user_rental %}
        <form action="{% url 'cancel_rental' user_rental.id %}" method="post" class="cancel-rental-form">
            {% csrf_token %}
            <input type="submit" value="Anuluj rezerwację" class="btn btn-danger car-action-btn">
        </form>
        {% endif %}
    </div>
    
    <div class="comments-section">
        {% with comments.count as total_comments %}
        <h2 class="comments-header">
            {{ total_comments }} komentarz{{ total_comments|pluralize:"y" }}
        </h2>
        {% endwith %}
        {% for comment in comments %}
        <div class="comment">
            <p class="comment-header">
                Komentarz {{forloop.counter }} dodany przez {{ comment.user }} {{ comment.created }}
            </p>
            <p class="comment-body">{{ comment.body|linebreaks }}</p>
        </div>
        {% empty %}
        <p class="no-comments-info">Nie ma jeszcze żadnych komentarzy.</p>
        {% endfor %}
        
        {% if new_comment %}
        <h2 class="new-comment-info">Twój komentarz został dodany.</h2>
        {% else %}
        <h2 class="add-comment-header">Dodaj nowy komentarz</h2>
        <form action="." method="post" class="comment-form">
            {% csrf_token %}
            <label for="{{ comment_form.body.id_for_label }}">Dodaj komentarz:</label>
            {{ comment_form.body }}
            <input type="submit" value="Dodaj komentarz" class="btn btn-primary car-action-btn">
        </form>
        {% endif %}
    </div>
{% endblock %}
